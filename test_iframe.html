<head>
    <script type="text/javascript">

    function alertCookie() {
        alert(document.cookie);
    }

    function eraseCookieFromAllPaths() {
        var c = document.cookie.split("; ");
        for (i in c)
            document.cookie =/^[^=]+/.exec(c[i])[0]+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }

    function getCookie(cname) {
        var name = cname + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var ca = decodedCookie.split(';');
        for(var i = 0; i <ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    }

    var MYCOOKIE='iframe_cookie_xxx_'

    function addCookie(num, same) {
        var date = new Date();
        date.setTime(date.getTime() + (7*24*60*60*1000));
        var expires = '';
        expires = 'expires=' + date.toUTCString();

        var same = '';
        if (same == true) {
            same = '; Secure; SameSite=None;';
        }
        document.cookie = MYCOOKIE + num + ' = ' + num + '; ' + expires + same;
    }

    function delCookie(num) {
        document.cookie = MYCOOKIE + num + '=; Max-Age=0'
    }

    function showCookie(num) {
        var value = getCookie(MYCOOKIE + num);
        if (value != null && value != '') {
            alert(MYCOOKIE + num + " = " + value);
        } else {
            alert('can\'t find ' + MYCOOKIE + num);
        }
    }

    function reqAccess() {
        var output_log = '';
        if (document.hasStorageAccess && document.requestStorageAccess) {
            output_log =+ 'User-agent: ' + navigator.userAgent + '\n';
            document.hasStorageAccess().then(
                function successful(hasAccess) {
                    console.log('Testing if hasAccess');
                    if (hasAccess) {
                        console.log('Access granted already');
                    } else {
                        console.log('Requesting access');
                        document.requestStorageAccess().then(
                            function successful() {
                                console.log('Access request was a success');
                                window.location.reload();
                            },
                            function fail() {
                                console.log('Storage Access API call failed...');
                            });
                    }
                },
                function rejected(reason) {
                    console.log('hasStorageAccess failed: ', reason);
                });
        } else {

        }
        alert(output_log);
    }
    </script>
</head>
<body>
    <button onclick="reqAccess()">Request storage access</button>
    <br>
    <br>
    <div>iframe with cookies</div>
    <button onclick="alertCookie()">Show all cookies</button><br>
    <button onclick="eraseCookieFromAllPaths()">Delete all cookies</button><br>
    <br>
    <button onclick="addCookie(1, true)">Add iframe cookie-1</button><br>
    <button onclick="delCookie(1)">Delete iframe cookie-1</button><br>
    <button onclick="showCookie(1)">Show iframe cookie-1</button><br>
    <br>
    <button onclick="addCookie(2, true)">Add iframe cookie-3</button><br>
    <button onclick="delCookie(2)">Delete iframe cookie-3</button><br>
    <button onclick="showCookie(2)">Show iframe cookie-3</button><br>
    <br>
    <button onclick="addCookie(3, false)">Add iframe cookie-3</button><br>
    <button onclick="delCookie(3)">Delete iframe cookie-3</button><br>
    <button onclick="showCookie(3)">Show iframe cookie-3</button><br>
</body>
